<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9 http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">
	<changeSet author="KFS50" id="pur_po_itm_tot_amt_v">
		<comment>KFSMI-6745</comment>
		<createView viewName="pur_po_itm_tot_amt_v"
			replaceIfExists="true"><![CDATA[
		select fdoc_nbr, sum(
                     CASE
                     WHEN ITM_ACTV_IND = 'Y' AND ITM_ORD_QTY IS NULL THEN ITM_UNIT_PRC
                     WHEN ITM_ACTV_IND = 'Y' AND ITM_ORD_QTY IS NOT NULL THEN ITM_ORD_QTY * ITM_UNIT_PRC
                     WHEN ITM_ACTV_IND IS NULL AND ITM_ORD_QTY IS NULL THEN ITM_UNIT_PRC
                     WHEN ITM_ACTV_IND IS NULL AND ITM_ORD_QTY IS NOT NULL THEN ITM_ORD_QTY * ITM_UNIT_PRC
                     WHEN ITM_ACTV_IND ='N' THEN 0
                     ELSE 0
                       END) as TOTAL_AMOUNT
       from pur_po_itm_t group by fdoc_nbr
		]]></createView>
	</changeSet>
	<changeSet author='KFS50' id='KFS_50_AddColumn_DISPLAY_TO_USER_IND'>
		<comment>KFSMI-KFSMI-6486 Add a new column to PUR_PO_TRNS_MTHD_T</comment>
		<addColumn tableName='pur_po_trns_mthd_t'>
			<column name='DISPLAY_TO_USER_IND' type='VARCHAR2(1)' />
		</addColumn>
		<modifySql dbms='mysql'>
			<replace replace='VARCHAR2' with='VARCHAR' />
		</modifySql>
	</changeSet>

	<changeSet author='KFS50' id='addCol_PUR_REQS_T'>
		<comment>KFSMI-6951 Need to add new columns to the existing tables</comment>
		<addColumn tableName='PUR_REQS_T'>
			<column name='ACCT_DISTR_MTD_IND' type='VARCHAR2(1)'
				defaultValue='P'>
				<constraints nullable='false' />
			</column>
		</addColumn>
		<modifyColumn tableName='PUR_REQS_ACCT_T'>
			<column name='ACLN_PCT' type='NUMBER(35,20)'>
				<constraints nullable='false' />
			</column>
		</modifyColumn>
		<addColumn tableName='PUR_REQS_ACCT_T'>
			<column name='FDOC_LINE_NBR' type='NUMBER(7,0)'>
				<constraints nullable='false' />
			</column>
		</addColumn>
		<addColumn tableName='PUR_PO_T'>
			<column name='ACCT_DISTR_MTD_IND' type='VARCHAR2(1)'
				defaultValue='P'>
				<constraints nullable='false' />
			</column>
		</addColumn>
		<modifyColumn tableName='PUR_PO_ACCT_T'>
			<column name='ACLN_PCT' type='NUMBER(35,20)'>
				<constraints nullable='false' />
			</column>
		</modifyColumn>
		<addColumn tableName='PUR_PO_ACCT_T'>
			<column name='FDOC_LINE_NBR' type='NUMBER(7,0)'>
				<constraints nullable='false' />
			</column>
		</addColumn>
		<addColumn tableName='AP_PMT_RQST_T'>
			<column name='ACCT_DISTR_MTD_IND' type='VARCHAR2(1)'
				defaultValue='P'>
				<constraints nullable='false' />
			</column>
		</addColumn>

		<addColumn tableName='AP_PMT_RQST_ACCT_T'>
			<column name='FDOC_LINE_NBR' type='NUMBER(7,0)'>
				<constraints nullable='false' />
			</column>
		</addColumn>
		<addColumn tableName='AP_CRDT_MEMO_T'>
			<column name='ACCT_DISTR_MTD_IND' type='VARCHAR2(1)'
				defaultValue='P'>
				<constraints nullable='false' />
			</column>
		</addColumn>
		<addColumn tableName='AP_CRDT_MEMO_ACCT_T'>
			<column name='FDOC_LINE_NBR' type='NUMBER(7,0)'>
				<constraints nullable='false' />
			</column>
		</addColumn>
		<modifySql dbms='mysql'>
			<replace replace='VARCHAR2' with='VARCHAR' />
		</modifySql>
		<modifySql dbms='mysql'>
			<replace replace='NUMBER' with='DECIMAL' />
		</modifySql>
	</changeSet>

</databaseChangeLog>
