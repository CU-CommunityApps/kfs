<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog/1.9"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog/1.9 http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-1.9.xsd">

	<changeSet author="KFS50" id="Drop_FP_CPTL_AST_INFO_DTL_Oracle"
		dbms="oracle">
		<sql>
			DROP
			TABLE FP_CPTL_AST_INFO_DTL_T CASCADE CONSTRAINTS;
			DROP TABLE
			FP_CPTL_AST_INFO_T CASCADE CONSTRAINTS;
		</sql>
	</changeSet>

	<changeSet author="KFS50" id="Drop_FP_CPTL_AST_INFO_DTL_Mysql"
		dbms="mysql">
		<sql>
			DROP
			TABLE IF EXISTS FP_CPTL_AST_INFO_DTL_T CASCADE;
			DROP TABLE IF EXISTS
			FP_CPTL_AST_INFO_T CASCADE;
		</sql>
	</changeSet>

	<changeSet author="KFS50" id="FP_PRCRMNT_CARD_TRN_T">
		<comment>KFSMI-7021, 5999</comment>
		<createTable tableName="FP_CPTL_AST_INFO_T">
			<column name="FDOC_NBR" type="VARCHAR2(14)">
				<constraints nullable="false" />
			</column>
			<column name="OBJ_ID" type="VARCHAR2(36)">
				<constraints nullable="false" />
			</column>
			<column name="VER_NBR" type="NUMBER(8,0)" defaultValue="1">
				<constraints nullable="false" />
			</column>
			<column name="CPTLAST_LINE_NBR" type="NUMBER(7,0)"
				defaultValue="1">
				<constraints nullable="false" />
			</column>
			<column name="VNDR_HDR_GNRTD_ID" type="NUMBER(10,0)">
				<constraints nullable="true" />
			</column>
			<column name="VNDR_DTL_ASND_ID" type="NUMBER(10,0)">
				<constraints nullable="true" />
			</column>
			<column name="CPTLAST_NBR" type="NUMBER(12,0)">
				<constraints nullable="true" />
			</column>
			<column name="CPTLAST_TYP_CD" type="VARCHAR2(7)">
				<constraints nullable="true" />
			</column>
			<column name="CPTLAST_MFR_NM" type="VARCHAR2(45)">
				<constraints nullable="true" />
			</column>
			<column name="CPTLAST_DESC" type="VARCHAR2(4000)">
				<constraints nullable="true" />
			</column>
			<column name="CPTLAST_MFRMDL_NBR" type="VARCHAR2(25)">
				<constraints nullable="true" />
			</column>
			<column name="CPTLAST_LINE_QTY" type="NUMBER(7,0)"
				defaultValue="0">
				<constraints nullable="true" />
			</column>
			<column name="CPTLAST_LINE_AMT" type="NUMBER(19,2)"
				defaultValue="0.00">
				<constraints nullable="true" />
			</column>
			<column name="CPTLAST_ACTION_IND" type="VARCHAR2(1)"
				defaultValue="C">
				<constraints nullable="false" />
			</column>
			<column name="CPTLAST_PROCESSED_IND" type="VARCHAR2(1)"
				defaultValue="N">
				<constraints nullable="false" />
			</column>
		</createTable>
		<addPrimaryKey tableName="FP_CPTL_AST_INFO_T"
			constraintName="pk_cptl_ast_info" columnNames="FDOC_NBR, CPTLAST_LINE_NBR" />

		<createTable tableName="FP_CPTL_AST_INFO_DTL_T">
			<column name="FDOC_NBR" type="VARCHAR2(14)">
				<constraints nullable="false" />
			</column>
			<column name="CPTLAST_LINE_NBR" type="NUMBER(7,0)">
				<constraints nullable="false" />
			</column>
			<column name="ITM_LN_NBR" type="NUMBER(7,0)">
				<constraints nullable="false" />
			</column>
			<column name="OBJ_ID" type="VARCHAR2(36)">
				<constraints nullable="false" />
			</column>
			<column name="VER_NBR" type="NUMBER(8,0)">
				<constraints nullable="false" />
			</column>
			<column name="CAMPUS_CD" type="VARCHAR2(2)">
				<constraints nullable="true" />
			</column>
			<column name="BLDG_CD" type="VARCHAR2(10)">
				<constraints nullable="true" />
			</column>
			<column name="BLDG_ROOM_NBR" type="VARCHAR2(8)">
				<constraints nullable="true" />
			</column>
			<column name="BLDG_SUB_ROOM_NBR" type="VARCHAR2(2)">
				<constraints nullable="true" />
			</column>
			<column name="CPTLAST_TAG_NBR" type="VARCHAR2(8)">
				<constraints nullable="true" />
			</column>
			<column name="CPTLAST_SERIAL_NBR" type="VARCHAR2(25)">
				<constraints nullable="true" />
			</column>
		</createTable>

		<addPrimaryKey tableName="FP_CPTL_AST_INFO_DTL_T"
			constraintName="pk_cptl_ast_info_dtl" columnNames="FDOC_NBR, ITM_LN_NBR, CPTLAST_LINE_NBR" />

		<addForeignKeyConstraint constraintName="FP_CPTL_AST_INFO_DTL_TR1"
			baseTableName="FP_CPTL_AST_INFO_DTL_T" baseColumnNames="FDOC_NBR, CPTLAST_LINE_NBR"
			referencedTableName="FP_CPTL_AST_INFO_T" referencedColumnNames="FDOC_NBR, CPTLAST_LINE_NBR" />

		<createTable tableName="FP_CPTL_AST_ACCT_GRP_DTL_T">
			<column name="FDOC_NBR" type="VARCHAR2(14)">
				<constraints nullable="false" />
			</column>
			<column name="OBJ_ID" type="VARCHAR2(36)">
				<constraints nullable="false" />
			</column>
			<column name="VER_NBR" type="NUMBER(8,0)" defaultValue="1">
				<constraints nullable="false" />
			</column>
			<column name="CPTLAST_LINE_NBR" type="NUMBER(7,0)"
				defaultValue="1">
				<constraints nullable="false" />
			</column>
			<column name="CPTLAST_ACCTLINE_NBR" type="NUMBER(7,0)"
				defaultValue="1">
				<constraints nullable="false" />
			</column>
			<column name="FDOC_LINE_NBR" type="NUMBER(7,0)" defaultValue="1">
				<constraints nullable="false" />
			</column>
			<column name="FDOC_LN_TYP_CD" type="VARCHAR2(1)">
				<constraints nullable="false" />
			</column>
			<column name="FIN_COA_CD" type="VARCHAR2(2)">
				<constraints nullable="false" />
			</column>
			<column name="ACCOUNT_NBR" type="VARCHAR2(7)">
				<constraints nullable="false" />
			</column>
			<column name="FIN_OBJECT_CD" type="VARCHAR2(4)">
				<constraints nullable="false" />
			</column>
			<column name="FDOC_LINE_AMT" type="NUMBER(19,2)" defaultValue="0.00">
				<constraints nullable="true" />
			</column>
		</createTable>

		<addPrimaryKey tableName="FP_CPTL_AST_ACCT_GRP_DTL_T"
			constraintName="pk_fp_cptl_ast_acct_grp_dtl"
			columnNames="FDOC_NBR, CPTLAST_LINE_NBR, CPTLAST_ACCTLINE_NBR, FDOC_LINE_NBR" />

		<addForeignKeyConstraint constraintName="FP_CPTL_AST_ACCT_GRP_DTL_TR1"
			baseTableName="FP_CPTL_AST_ACCT_GRP_DTL_T" baseColumnNames="FDOC_NBR, CPTLAST_LINE_NBR"
			referencedTableName="FP_CPTL_AST_INFO_T" referencedColumnNames="FDOC_NBR, CPTLAST_LINE_NBR" />

		<comment>Add fields, create parameters, permissions, and roles for KSMI-6702 Contribution</comment>
		<addColumn tableName='FP_INT_BILL_DOC_T'>
			<column name='FDOC_POST_PRD_CD' type='VARCHAR2(3)' />
		</addColumn>
		<addColumn tableName='FP_DISTRIB_DOC_T'>
			<column name='FDOC_POST_PRD_CD' type='VARCHAR2(3)' />
		</addColumn>
		<addColumn tableName='FP_ICR_ADJ_DOC_T'>
			<column name='FDOC_POST_PRD_CD' type='VARCHAR2(3)' />
		</addColumn>

		<comment>KFSMI-6720 rename FP_PRCRMNT_CARD_TRN_T to be renamed to FP_PRCRMNT_CARD_TRN_MT </comment>
		<renameTable oldTableName="FP_PRCRMNT_CARD_TRN_T" newTableName="FP_PRCRMNT_CARD_TRN_MT" />
		
		<modifySql dbms="mysql">
			<replace replace="VARCHAR2" with="VARCHAR" />
			<replace replace="NUMBER" with="DECIMAL" />
		</modifySql>
	</changeSet>


	<changeSet author='KFS50' id='KFS_50_FP_REVOLVFND_DTL_T_Oracle'
		dbms="oracle">
		<comment>KFSMI-KFSMI-6971 Remove fdoc_column_typ_cd from remaining tables</comment>
		<dropTable tableName='FP_REVOLVFND_DTL_T' />
		<dropPrimaryKey tableName="FP_ADV_DPST_DTL_T" />
		<dropColumn tableName='FP_ADV_DPST_DTL_T' columnName='FDOC_COLUMN_TYP_CD' />
		<addPrimaryKey tableName='FP_ADV_DPST_DTL_T'
			constraintName='FP_ADV_DPST_DTL_TP1' columnNames='FDOC_NBR, FDOC_TYP_CD, FDOC_LINE_NBR' />
		<dropPrimaryKey tableName="FP_CR_CARD_DTL_T" />
		<dropColumn tableName='FP_CR_CARD_DTL_T' columnName='FDOC_COLUMN_TYP_CD' />
		<addPrimaryKey tableName='FP_CR_CARD_DTL_T'
			constraintName='FP_CR_CARD_DTL_TP1' columnNames='FDOC_NBR, FDOC_TYP_CD, FDOC_LINE_NBR' />
		<comment>KFSMI-6720 rename FP_PRCRMNT_CARD_TRN_T to be renamed to FP_PRCRMNT_CARD_TRN_MT </comment>
		<sql>
			RENAME FP_PRCRMNT_CARD_TRN_T_SEQ TO FP_PRCRMNT_CARD_TRN_MT_SEQ;
		</sql>
	</changeSet>

	<changeSet author='KFS50' id='KFS_50_FP_REVOLVFND_DTL_T_mysql'
		dbms="mysql">
		<comment>KFSMI-KFSMI-6971 Remove fdoc_column_typ_cd from remaining tables</comment>
		<dropTable tableName='FP_REVOLVFND_DTL_T' />
		<sql>ALTER TABLE FP_ADV_DPST_DTL_T DROP PRIMARY KEY, ADD PRIMARY KEY
			(FDOC_NBR, FDOC_TYP_CD, FDOC_LINE_NBR);
		</sql>
		<dropColumn tableName='FP_ADV_DPST_DTL_T' columnName='FDOC_COLUMN_TYP_CD' />
		<sql>ALTER TABLE FP_CR_CARD_DTL_T DROP PRIMARY KEY, ADD PRIMARY KEY
			(FDOC_NBR, FDOC_TYP_CD, FDOC_LINE_NBR);
		</sql>
		<dropColumn tableName='FP_CR_CARD_DTL_T' columnName='FDOC_COLUMN_TYP_CD' />
		
		<comment>KFSMI-6720 rename FP_PRCRMNT_CARD_TRN_T to be renamed to FP_PRCRMNT_CARD_TRN_MT </comment>
		<renameTable oldTableName="FP_PRCRMNT_CARD_TRN_T_SEQ" newTableName="FP_PRCRMNT_CARD_TRN_MT_SEQ" />
		
	</changeSet>

	<changeSet author='KFS50' id='KFS_50_FP_DEPOSIT_HDR_T'>
		<comment>KFSMI-KFSMI-6966 Need the ability to recategorize checks/currency/coins from CRs</comment>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_100_DLR_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_50_DLR_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_20_DLR_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_10_DLR_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_5_DLR_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_2_DLR_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_1_DLR_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_OTHR_DLR_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_100_CENT_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_50_CENT_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_25_CENT_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_10_CENT_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_5_CENT_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_1_CENT_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_DEPOSIT_HDR_T'>
			<column name='FDOC_MSTR_OTHR_CENT_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_COIN_DTL_T'>
			<column name='CSHR_STAT_CD' type='VARCHAR2(1)' />
		</addColumn>
		<addColumn tableName='FP_CHECK_DTL_T'>
			<column name='CSHR_STAT_CD' type='VARCHAR2(1)' />
		</addColumn>
		<addColumn tableName='FP_CURRENCY_DTL_T'>
			<column name='CSHR_STAT_CD' type='VARCHAR2(1)' />
		</addColumn>
		<update tableName='FP_CURRENCY_DTL_T'>
			<column name='CSHR_STAT_CD' value='X' />
			<where>FDOC_TYP_CD = 'CD' or FDOC_TYP_CD = 'BCS' or FDOC_TYP_CD =
				'CH'
			</where>
		</update>

		<update tableName='FP_CHECK_DTL_T'>
			<column name='CSHR_STAT_CD' value='X' />
			<where>FDOC_TYP_CD = 'CD' or FDOC_TYP_CD = 'BCS' or FDOC_TYP_CD =
				'CH'
			</where>
		</update>
		<update tableName='FP_COIN_DTL_T'>
			<column name='CSHR_STAT_CD' value='X' />
			<where>FDOC_TYP_CD = 'CD' or FDOC_TYP_CD = 'BCS' or FDOC_TYP_CD =
				'CH'
			</where>
		</update>
		<delete tableName='FP_CURRENCY_DTL_T'>
			<where>FDOC_TYP_CD = 'BCS'</where>
		</delete>
		<delete tableName='FP_CURRENCY_DTL_T'>
			<where>FDOC_TYP_CD = 'CH'</where>
		</delete>
		<delete tableName='FP_COIN_DTL_T'>
			<where>FDOC_TYP_CD = 'BCS'</where>
		</delete>
		<delete tableName='FP_COIN_DTL_T'>
			<where>FDOC_TYP_CD = 'CH'</where>
		</delete>
		<update tableName='FP_CURRENCY_DTL_T'>
			<column name='CSHR_STAT_CD' value='C' />
			<where>FDOC_TYP_CD = 'CR' and FDOC_COLUMN_TYP_CD = 'C' </where>
		</update>
		<update tableName='FP_CHECK_DTL_T'>
			<column name='CSHR_STAT_CD' value='C' />
			<where>FDOC_TYP_CD = 'CR' and FDOC_COLUMN_TYP_CD = 'C' </where>
		</update>
		<update tableName='FP_COIN_DTL_T'>
			<column name='CSHR_STAT_CD' value='C' />
			<where>FDOC_TYP_CD = 'CR' and FDOC_COLUMN_TYP_CD = 'C' </where>
		</update>
		<update tableName='FP_CURRENCY_DTL_T'>
			<column name='CSHR_STAT_CD' value='R' />
			<where>FDOC_TYP_CD = 'CR' and FDOC_COLUMN_TYP_CD = 'R' </where>
		</update>
		<update tableName='FP_CHECK_DTL_T'>
			<column name='CSHR_STAT_CD' value='R' />
			<where>FDOC_TYP_CD = 'CR' and FDOC_COLUMN_TYP_CD = 'R' </where>
		</update>
		<update tableName='FP_COIN_DTL_T'>
			<column name='CSHR_STAT_CD' value='R' />
			<where>FDOC_TYP_CD = 'CR' and FDOC_COLUMN_TYP_CD = 'R' </where>
		</update>
		<update tableName='FP_CURRENCY_DTL_T'>
			<column name='FDOC_TYP_CD' value='CMD' />
			<where>FDOC_TYP_CD = 'CM'</where>
		</update>
		<update tableName='FP_CHECK_DTL_T'>
			<column name='FDOC_TYP_CD' value='CMD' />
			<where>FDOC_TYP_CD = 'CM'</where>
		</update>
		<update tableName='FP_COIN_DTL_T'>
			<column name='FDOC_TYP_CD' value='CMD' />
			<where>FDOC_TYP_CD = 'CM'</where>
		</update>
		<update tableName='FP_CURRENCY_DTL_T'>
			<column name='CSHR_STAT_CD' value='R' />
			<where>FDOC_TYP_CD = 'CMD' and FDOC_COLUMN_TYP_CD = 'R'</where>
		</update>
		<update tableName='FP_CURRENCY_DTL_T'>
			<column name='CSHR_STAT_CD' value='D' />
			<where>FDOC_TYP_CD = 'CMD' and FDOC_COLUMN_TYP_CD = 'D'</where>
		</update>
		<update tableName='FP_CURRENCY_DTL_T'>
			<column name='CSHR_STAT_CD' value='O' />
			<where>FDOC_TYP_CD = 'CMD' and FDOC_COLUMN_TYP_CD = 'O'</where>
		</update>
		<update tableName='FP_CURRENCY_DTL_T'>
			<column name='CSHR_STAT_CD' value='M' />
			<where>FDOC_TYP_CD = 'CMD' and FDOC_COLUMN_TYP_CD = 'M'</where>
		</update>
		<update tableName='FP_CURRENCY_DTL_T'>
			<column name='CSHR_STAT_CD' value='C' />
			<where>FDOC_TYP_CD = 'CMD' and FDOC_COLUMN_TYP_CD = 'C'</where>
		</update>
		<update tableName='FP_COIN_DTL_T'>
			<column name='CSHR_STAT_CD' value='R' />
			<where>FDOC_TYP_CD = 'CMD' and FDOC_COLUMN_TYP_CD = 'R'</where>
		</update>
		<update tableName='FP_COIN_DTL_T'>
			<column name='CSHR_STAT_CD' value='D' />
			<where>FDOC_TYP_CD = 'CMD' and FDOC_COLUMN_TYP_CD = 'D'</where>
		</update>
		<update tableName='FP_COIN_DTL_T'>
			<column name='CSHR_STAT_CD' value='O' />
			<where>FDOC_TYP_CD = 'CMD' and FDOC_COLUMN_TYP_CD = 'O'</where>
		</update>
		<update tableName='FP_COIN_DTL_T'>
			<column name='CSHR_STAT_CD' value='M' />
			<where>FDOC_TYP_CD = 'CMD' and FDOC_COLUMN_TYP_CD = 'M'</where>
		</update>
		<update tableName='FP_COIN_DTL_T'>
			<column name='CSHR_STAT_CD' value='C' />
			<where>FDOC_TYP_CD = 'CMD' and FDOC_COLUMN_TYP_CD = 'C'</where>
		</update>
		<update tableName='FP_CHECK_DTL_T'>
			<column name='CSHR_STAT_CD' value='R' />
			<where>FDOC_TYP_CD = 'CMD' and FDOC_COLUMN_TYP_CD = 'I'</where>
		</update>
		<dropPrimaryKey tableName="FP_CURRENCY_DTL_T" />
		<addPrimaryKey tableName='FP_CURRENCY_DTL_T'
			constraintName='FP_CURRENCY_DTL_T_TP1' columnNames=' FDOC_NBR,  FDOC_TYP_CD, CSHR_STAT_CD ' />
		<dropPrimaryKey tableName="FP_CHECK_DTL_T" />
		<addPrimaryKey tableName='FP_CHECK_DTL_T'
			constraintName='FP_CHECK_DTL_TP1' columnNames='FDOC_NBR, FDOC_TYP_CD, CSHR_STAT_CD, FDOC_LINE_NBR' />
		<dropPrimaryKey tableName="FP_COIN_DTL_T" />
		<addPrimaryKey tableName='FP_COIN_DTL_T' constraintName='FP_COIN_DTL_T_TP1'
			columnNames=' FDOC_NBR,  FDOC_TYP_CD, CSHR_STAT_CD ' />
		<dropColumn tableName='FP_DEPOSIT_HDR_T' columnName='FDOC_REF_NBR' />
		<addColumn tableName='FP_CASH_RCPT_DOC_T'>
			<column name='FDOC_CNFRMD_CASH_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_CASH_RCPT_DOC_T'>
			<column name='FDOC_CNFRMD_CHCK_AMT' type='NUMBER(19,2)' />
		</addColumn>
		<addColumn tableName='FP_CASH_RCPT_DOC_T'>
			<column name='FDOC_CNFRMD_COIN_AMT' type='NUMBER(19,2)' />
		</addColumn>

		<comment>KFSMI-KFSMI-7175 We need to add a column to FP_CPTL_AST_INFO_T and CM_AST_PMT_DOC_T tables for enhancement work on KFSMI-7106</comment>
		<addColumn tableName='FP_CPTL_AST_INFO_T'>
			<column name='CPTLAST_DST_AMT_CD' type='VARCHAR2(1)'
				defaultValue="1">
				<constraints nullable="true" />
			</column>
		</addColumn>
		<modifySql dbms='mysql'>
			<replace replace='VARCHAR2' with='VARCHAR' />
			<replace replace='NUMBER' with='DECIMAL' />
		</modifySql>
	</changeSet>
</databaseChangeLog>
