<!--
    Copyright 2012 The Kuali Foundation

    Licensed under the Educational Community License, Version 2.0 (the "License");
    you may not use this file except in compliance with the License.
    You may obtain a copy of the License at

    http://www.opensource.org/licenses/ecl2.php

    Unless required by applicable law or agreed to in writing, software
    distributed under the License is distributed on an "AS IS" BASIS,
    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    See the License for the specific language governing permissions and
    limitations under the License.
-->
<databaseChangeLog xmlns='http://www.liquibase.org/xml/ns/dbchangelog'
	xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance'
	xsi:schemaLocation='http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-2.0.xsd'>

	<changeSet author="KFS50" id="ADD_NAMESPACE_TO_TYPE_SERVICES">
		<comment>In Rice 2.0, the KIM type services need to be qualified by their namespace to work with a Rice standalone Server.</comment>
		<sql>
			UPDATE KRIM_TYP_T 
			    SET SRVC_NM = CONCAT('{KFS}',SRVC_NM)
			WHERE nmspc_cd LIKE 'KFS%'
		</sql>
	</changeSet>

	<changeSet author="KFS50" id="KFSAR-6012">
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSAR6012" />
			<column name="OBJ_ID" value="KFSAR6012" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="PERM_TMPL_ID" value="33" />
			<column name="NMSPC_CD" value="KFS-AR" />
			<column name="NM" value="Upload Customer CSV Files" />
			<column name="DESC_TXT"
				value="Allows access to the Customer Upload Batch Upload page." />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSAR6012-1" />
			<column name="OBJ_ID" value="KFSAR6012-1" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="PERM_ID" value="KFSAR6012" />
			<column name="KIM_TYP_ID" value="15" />
			<column name="KIM_ATTR_DEFN_ID" value="1" />
			<column name="ATTR_VAL" value="customerLoadCSVInputFileType" />
		</insert>
		<!-- Assign the permission to Roles KFS-SYS/User and KFS-SYS/System User -->
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSAR6012-1" />
			<column name="OBJ_ID" value="KFSAR6012-1" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" value="2" />
			<column name="PERM_ID" value="KFSAR6012" />
			<column name="ACTV_IND" value="Y" />
		</insert>
	</changeSet>
	<changeSet author="KFS50" id="KFSMI-6808">
		<!-- KFSMI 6808 Allow Sub-Account routing by Chart/Org/Sub-account -->
		<update tableName="KRIM_TYP_ATTR_T">
			<column name="sort_cd" value="e" />
			<where>kim_typ_attr_id='78' and sort_cd='d'</where>
		</update>
		<sql><![CDATA[
			insert into KRIM_TYP_ATTR_T (kim_typ_attr_id, obj_id, ver_nbr,
			sort_cd,
			kim_typ_id, kim_attr_defn_id, actv_ind)
			values ('KFSSEC1010',
			'KFSSEC1010', 1, 'd',
			(select kim_typ_id from KRIM_TYP_T where
			nmspc_cd = 'KFS-COA' and nm =
			'Sub-Account & Document Type'),
			(select
			kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KFS-COA'
			and
			nm = 'organizationCode'),
			'Y');
		]]></sql>
	</changeSet>

	<changeSet author="KFS50" id="KFSPURAP-6940">
		<!--KFSMI-KFSMI-6940 Establish permission for fully Unmask Field for purapDocumentIdentifier 
			attribute -->
		<insert tableName='KRIM_PERM_T'>
			<column name='PERM_ID' value='KFSPURAP6940' />
			<column name='OBJ_ID' value='KFSPURAP6940' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='PERM_TMPL_ID' value='27' />
			<column name='NMSPC_CD' value='KFS-PURAP' />
			<column name='NM' value='Unmask PO # On PO Document' />
			<column name='DESC_TXT'
				value='Authorizes users to view the entire Purchase Order Number on the PO Document and Inquiry' />
			<column name='ACTV_IND' value='Y' />
		</insert>
		<insert tableName='KRIM_PERM_ATTR_DATA_T'>
			<column name='ATTR_DATA_ID' value='KFSPURAP6940-01' />
			<column name='OBJ_ID' value='KFSPURAP6940-01' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='PERM_ID' value='KFSPURAP6940' />
			<column name='KIM_TYP_ID' value='11' />
			<column name='KIM_ATTR_DEFN_ID' value='5' />
			<column name='ATTR_VAL' value='PurchaseOrderDocument' />
		</insert>
		<insert tableName='KRIM_PERM_ATTR_DATA_T'>
			<column name='ATTR_DATA_ID' value='KFSPURAP6940-02' />
			<column name='OBJ_ID' value='KFSPURAP6940-02' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='PERM_ID' value='KFSPURAP6940' />
			<column name='KIM_TYP_ID' value='11' />
			<column name='KIM_ATTR_DEFN_ID' value='6' />
			<column name='ATTR_VAL' value='purapDocumentIdentifier' />
		</insert>
		<insert tableName='KRIM_ROLE_PERM_T'>
			<column name='ROLE_PERM_ID' value='KFSPURAP6940-01' />
			<column name='OBJ_ID' value='KFSPURAP6940-01' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='ROLE_ID' value='26' />
			<column name='PERM_ID' value='KFSPURAP6940' />
			<column name='ACTV_IND' value='Y' />
		</insert>
	</changeSet>
	<changeSet author="KFS50" id="KFSPURAP-7037">		
		<insert tableName='KRIM_RSP_T'>
			<column name='RSP_ID' value='126' />
			<column name='OBJ_ID' value='KFSPURAP7037' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='RSP_TMPL_ID' value='1' />
			<column name='NMSPC_CD' value='KFS-FP' />
			<column name='NM' value='Review DV SeparationOfDuties' />
			<column name='DESC_TXT' value='' />
			<column name='ACTV_IND' value='Y' />
		</insert>
		<insert tableName='KRIM_RSP_ATTR_DATA_T'>
			<column name='ATTR_DATA_ID' value='KFSFP7037A' />
			<column name='OBJ_ID' value='KFSFP7037A' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='RSP_ID' value='126' />
			<column name='KIM_TYP_ID' value='7' />
			<column name='KIM_ATTR_DEFN_ID' value='41' />
			<column name='ATTR_VAL' value='false' />
		</insert>
		<insert tableName='KRIM_RSP_ATTR_DATA_T'>
			<column name='ATTR_DATA_ID' value='KFSFP7037B' />
			<column name='OBJ_ID' value='KFSFP7037B' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='RSP_ID' value='126' />
			<column name='KIM_TYP_ID' value='7' />
			<column name='KIM_ATTR_DEFN_ID' value='16' />
			<column name='ATTR_VAL' value='SeparationOfDuties' />
		</insert>
		<insert tableName='KRIM_RSP_ATTR_DATA_T'>
			<column name='ATTR_DATA_ID' value='KFSFP7037C' />
			<column name='OBJ_ID' value='KFSFP7037C' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='RSP_ID' value='126' />
			<column name='KIM_TYP_ID' value='7' />
			<column name='KIM_ATTR_DEFN_ID' value='13' />
			<column name='ATTR_VAL' value='DV' />
		</insert>
		<insert tableName='KRIM_RSP_ATTR_DATA_T'>
			<column name='ATTR_DATA_ID' value='KFSFP7037D' />
			<column name='OBJ_ID' value='KFSFP7037D' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='RSP_ID' value='126' />
			<column name='KIM_TYP_ID' value='7' />
			<column name='KIM_ATTR_DEFN_ID' value='40' />
			<column name='ATTR_VAL' value='false' />
		</insert>
		<insert tableName='KRIM_ROLE_RSP_T'>
			<column name='ROLE_RSP_ID' value='KFSFP7037A' />
			<column name='OBJ_ID' value='KFSFP7037A' />
			<column name='VER_NBR' valueNumeric='4' />
			<column name='ROLE_ID' value='55' />
			<column name='RSP_ID' value='126' />
			<column name='ACTV_IND' value='Y' />
		</insert>
		<insert tableName='KRIM_ROLE_RSP_ACTN_T'>
			<column name='ROLE_RSP_ACTN_ID' value='KFSFP7037A' />
			<column name='OBJ_ID' value='KFSFP7037A' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='ACTN_TYP_CD' value='A' />
			<column name='PRIORITY_NBR' valueNumeric='1' />
			<column name='ACTN_PLCY_CD' value='F' />
			<column name='ROLE_MBR_ID' value='*' />
			<column name='ROLE_RSP_ID' value='KFSFP7037A' />
			<column name='FRC_ACTN' value='N' />
		</insert>
	</changeSet>
	<changeSet author="KFS50" id="KFSMI-6987">	
		<comment>KFSMI-KFSMI-6987 Employee Benefit Expense Calculation</comment>
		<insert tableName='KRIM_PERM_T'>
			<column name='PERM_ID' value='KFSLD6987' />
			<column name='OBJ_ID' value='KFSLD6987h' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='PERM_TMPL_ID' value='33' />
			<column name='NMSPC_CD' value='KFS-LD' />
			<column name='NM' value='Upload Labor Enterprise Feed Batch Files' />
			<column name='DESC_TXT'
				value='Allows access to the Labor Enterprise Feed Upload Batch Upload page.' />
			<column name='ACTV_IND' value='Y' />
		</insert>
		<insert tableName='KRIM_PERM_ATTR_DATA_T'>
			<column name='ATTR_DATA_ID' value='KFSLD6987' />
			<column name='OBJ_ID' value='KFSLD6987i' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='PERM_ID' value='KFSLD6987' />
			<column name='KIM_TYP_ID' value='15' />
			<column name='KIM_ATTR_DEFN_ID' value='1' />
			<column name='ATTR_VAL' value='laborEnterpriseFeederFileSetType' />
		</insert>
		<insert tableName='KRIM_ROLE_PERM_T'>
			<column name='ROLE_PERM_ID' value='45_KFSLD6987' />
			<column name='OBJ_ID' value='KFSLD6987j' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='ROLE_ID' value='45' />
			<column name='PERM_ID' value='KFSLD6987' />
			<column name='ACTV_IND' value='Y' />
		</insert>
	</changeSet>
	<changeSet author="KFS50" id="KFSMI-7145">
		<insert tableName='KRIM_PERM_T'>
			<column name='PERM_ID' value='KFSSYS7145a' />
			<column name='OBJ_ID' value='KFSSYS7145a' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='PERM_TMPL_ID' value='1' />
			<column name='NMSPC_CD' value='KFS-SYS' />
			<column name='NM' value='View Accounting Period' />
			<column name='DESC_TXT'
				value='Users who can view the accounting period field when enabled for year end processing.' />
			<column name='ACTV_IND' value='Y' />
		</insert>
		<insert tableName='KRIM_PERM_T'>
			<column name='PERM_ID' value='KFSSYS7145b' />
			<column name='OBJ_ID' value='KFSSYS7145b' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='PERM_TMPL_ID' value='1' />
			<column name='NMSPC_CD' value='KFS-SYS' />
			<column name='NM' value='Edit Accounting Period' />
			<column name='DESC_TXT'
				value='Users who can edit the accounting period field when enabled for year end processing.' />
			<column name='ACTV_IND' value='Y' />
		</insert>
		<insert tableName='KRIM_ROLE_T'>
			<column name='ROLE_ID' value='KFSSYS1' />
			<column name='OBJ_ID' value='KFSSYS7145' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='ROLE_NM' value='YearEnd' />
			<column name='NMSPC_CD' value='KFS-SYS' />
			<column name='DESC_TXT' value='Year End' />
			<column name='KIM_TYP_ID' value='1' />
			<column name='ACTV_IND' value='Y' />
		</insert>

		<insert tableName='KRIM_ROLE_PERM_T'>
			<column name='ROLE_PERM_ID' value='KFSSYS7145a-01' />
			<column name='OBJ_ID' value='KFSSYS7145a-01' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='ROLE_ID' value='54' />
			<column name='PERM_ID' value='KFSSYS7145a' />
			<column name='ACTV_IND' value='Y' />
		</insert>
		<insert tableName='KRIM_ROLE_PERM_T'>
			<column name='ROLE_PERM_ID' value='KFSSYS7145a-02' />
			<column name='OBJ_ID' value='KFSSYS7145a-02' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='ROLE_ID' value='KFSSYS1' />
			<column name='PERM_ID' value='KFSSYS7145a' />
			<column name='ACTV_IND' value='Y' />
		</insert>
		<insert tableName='KRIM_ROLE_PERM_T'>
			<column name='ROLE_PERM_ID' value='KFSSYS7145b-01' />
			<column name='OBJ_ID' value='KFSSYS7145b-01' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='ROLE_ID' value='54' />
			<column name='PERM_ID' value='KFSSYS7145b' />
			<column name='ACTV_IND' value='Y' />
		</insert>
		<insert tableName='KRIM_ROLE_PERM_T'>
			<column name='ROLE_PERM_ID' value='KFSSYS7145b-02' />
			<column name='OBJ_ID' value='KFSSYS7145b-02' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='ROLE_ID' value='22' />
			<column name='PERM_ID' value='KFSSYS7145b' />
			<column name='ACTV_IND' value='Y' />
		</insert>
		<insert tableName='KRIM_ROLE_PERM_T'>
			<column name='ROLE_PERM_ID' value='KFSSYS7145b-03' />
			<column name='OBJ_ID' value='KFSSYS7145b-03' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='ROLE_ID' value='16' />
			<column name='PERM_ID' value='KFSSYS7145b' />
			<column name='ACTV_IND' value='Y' />
		</insert>
		<insert tableName='KRIM_ROLE_PERM_T'>
			<column name='ROLE_PERM_ID' value='KFSSYS7145b-04' />
			<column name='OBJ_ID' value='KFSSYS7145b-04' />
			<column name='VER_NBR' valueNumeric='1' />
			<column name='ROLE_ID' value='KFSSYS1' />
			<column name='PERM_ID' value='KFSSYS7145b' />
			<column name='ACTV_IND' value='Y' />
		</insert>
	</changeSet>
	
	<changeSet author="KFS50" id="KFSMI307_IMMEDIATE_DV_DISBURSEMENT_PERMISSION">
		<comment>Creates a permission to allow KFS-SYS Operations and KFS-FP Disbursement Manager to set a DV for immediate disbursement.</comment>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSSYS6007"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="PERM_TMPL_ID" valueNumeric=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Use Transactional Document') "/>
			<column name="NMSPC_CD" value="KFS-FP"/>
			<column name="NM" value="Allow DV Immediate Disbursement"/>
			<column name="DESC_TXT" value="Allow Disbursement Voucher to be marked for immediate disbursement by the Pre-Disbursement Processor."/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSSYS6007-1"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="PERM_ID" value="KFSSYS6007"/>
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Use Transactional Document') "/>
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nm = 'documentTypeName') "/>
			<column name="ATTR_VAL" value="DV"/>
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSSYS6007-2"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="PERM_ID" value="KFSSYS6007"/>
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Use Transactional Document') "/>
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nm = 'editMode') "/>
			<column name="ATTR_VAL" value="immediateDisbursementEntryMode"/>
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSSYS6007-1"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="ROLE_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KFS-FP' and role_nm = 'Disbursement Manager') "/>
			<column name="PERM_ID" value="KFSSYS6007"/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSSYS6007-2"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="ROLE_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KFS-SYS' and role_nm = 'Operations') "/>
			<column name="PERM_ID" value="KFSSYS6007"/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
	    <modifySql dbms="mysql">
	      <replace replace="sys_guid()" with="uuid()" />
	    </modifySql>
	</changeSet>

	<changeSet author="KFS50" id="KFSMI4553_NEW_ROLE_FOR_VENDOR_REVIEWER">
		<comment>New KIM role type, role, and responsibility action for KFS-VND Exclude Single Actor Reviewer.  This one is ugly, sorry about that...</comment>
		<insert tableName="KRIM_TYP_T">
			<column name="KIM_TYP_ID" value="KFSMI4553-1"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="NMSPC_CD" value="KFS-SYS"/>
			<column name="NM" value="Exclude Single Actor Separation Of Duties"/>
			<column name="SRVC_NM" value="{KFS}excludeSingleActorSeparationOfDutiesRoleTypeService"/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
		<insert tableName="KRIM_ROLE_T">
			<column name="ROLE_ID" value="KFSMI4553-2"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="NMSPC_CD" value="KFS-VND"/>
			<column name="ROLE_NM" value="Exclude Single Actor Reviewer"/>
			<column name="KIM_TYP_ID" value="KFSMI4553-1"/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
		<insert tableName="KRIM_ROLE_MBR_T">
			<column name="ROLE_MBR_ID" value="KFSMI4553-3"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="ROLE_ID" value="KFSMI4553-2"/>
			<column name="MBR_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KFS-VND' and role_nm = 'Reviewer') "/>
			<column name="MBR_TYP_CD" value="R"/>
		</insert>
		<delete tableName="KRIM_ROLE_RSP_ACTN_T">
			<where>role_rsp_id in (select role_rsp_id from KRIM_ROLE_RSP_T where role_id = (select role_id from KRIM_ROLE_T where nmspc_cd = 'KFS-VND' and role_nm = 'Reviewer') and rsp_id = (select KRIM_RSP_T.rsp_id from KRIM_RSP_T join ((select rsp_id from KRIM_RSP_ATTR_DATA_T where kim_attr_defn_id = (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') and attr_val = 'PVEN') r_a_d1 join (select rsp_id from KRIM_RSP_ATTR_DATA_T where kim_attr_defn_id = (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'routeNodeName') and attr_val = 'Management') r_a_d2 on r_a_d1.rsp_id = r_a_d2.rsp_id) on KRIM_RSP_T.rsp_id = r_a_d1.rsp_id where KRIM_RSP_T.nmspc_cd = 'KFS-VND'))</where>
		</delete>
		<delete tableName="KRIM_ROLE_RSP_T">
			<where>role_id = (select role_id from KRIM_ROLE_T where nmspc_cd = 'KFS-VND' and role_nm = 'Reviewer') and rsp_id = (select KRIM_RSP_T.rsp_id from KRIM_RSP_T join ((select rsp_id from KRIM_RSP_ATTR_DATA_T where kim_attr_defn_id = (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') and attr_val = 'PVEN') r_a_d1 join (select rsp_id from KRIM_RSP_ATTR_DATA_T where kim_attr_defn_id = (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'routeNodeName') and attr_val = 'Management') r_a_d2 on r_a_d1.rsp_id = r_a_d2.rsp_id) on KRIM_RSP_T.rsp_id = r_a_d1.rsp_id where KRIM_RSP_T.nmspc_cd = 'KFS-VND')</where>
		</delete>
		<insert tableName="KRIM_ROLE_RSP_T">
			<column name="ROLE_RSP_ID" value="KFSMI4553-4"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="ROLE_ID" value="KFSMI4553-2"/>
			<column name="RSP_ID" valueNumeric=" (select KRIM_RSP_T.rsp_id from KRIM_RSP_T join ((select rsp_id from KRIM_RSP_ATTR_DATA_T where kim_attr_defn_id = (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') and attr_val = 'PVEN') r_a_d1 join (select rsp_id from KRIM_RSP_ATTR_DATA_T where kim_attr_defn_id = (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'routeNodeName') and attr_val = 'Management') r_a_d2 on r_a_d1.rsp_id = r_a_d2.rsp_id) on KRIM_RSP_T.rsp_id = r_a_d1.rsp_id where KRIM_RSP_T.nmspc_cd = 'KFS-VND') "/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
		<insert tableName="KRIM_ROLE_RSP_ACTN_T">
			<column name="ROLE_RSP_ACTN_ID" value="KFSMI4553-5"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="ACTN_TYP_CD" value="A"/>
			<column name="ACTN_PLCY_CD" value="F"/>
			<column name="ROLE_MBR_ID" value="*"/>
			<column name="ROLE_RSP_ID" value="KFSMI4553-4"/>
			<column name="FRC_ACTN" value="Y"/>
			<column name="PRIORITY_NBR" value="1"/>
		</insert>
	    <modifySql dbms="mysql">
	      <replace replace="sys_guid()" with="uuid()" />
	    </modifySql>
	</changeSet>
	
	<changeSet author="KFS50" id="ADD_FILEPATH_ROLE_TYPE">
		<insert tableName="KRIM_ATTR_DEFN_T">
			<column name="KIM_ATTR_DEFN_ID" value="KFSCNTRB199-ATTRDEF1" />
			<column name="OBJ_ID" value="KFSCNTRB199-ATTRDEF1"/>
			<column name="VER_NBR" value="1" />
			<column name="NMSPC_CD" value="KFS-SYS" />
			<column name="NM" value="filePath" />
			<column name="CMPNT_NM" value="org.kuali.kfs.sys.identity.KfsKimAttributes" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_TYP_T">
			<column name="KIM_TYP_ID" value="KFSCNTRB199-TYP1"/>
			<column name="OBJ_ID" value="KFSCNTRB199-TYP1"/>
			<column name="VER_NBR" value="1" />
			<column name="NMSPC_CD" value="KFS-SYS" />
			<column name="NM" value="Namespace or File Path" />
			<column name="SRVC_NM" value="{KFS}namespaceOrFilePathPermissionTypeService" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_TYP_ATTR_T">
			<column name="KIM_TYP_ATTR_ID" value="KFSCNTRB199-TYPATTR1" />
			<column name="OBJ_ID" value="KFSCNTRB199-TYPATTR1"/>
			<column name="VER_NBR" value="1" />
			<column name="SORT_CD" value="a" />
			<column name="KIM_TYP_ID" value="KFSCNTRB199-TYP1" />
			<column name="KIM_ATTR_DEFN_ID" value="4" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_TYP_ATTR_T">
			<column name="KIM_TYP_ATTR_ID" value="KFSCNTRB199-TYPATTR2" />
			<column name="OBJ_ID" value="KFSCNTRB199-TYPATTR2"/>
			<column name="VER_NBR" value="1" />
			<column name="SORT_CD" value="b" />
			<column name="KIM_TYP_ID" value="KFSCNTRB199-TYP1" />
			<column name="KIM_ATTR_DEFN_ID" value="KFSCNTRB199-ATTRDEF1" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		
	</changeSet>
	
	<changeSet author="KFS50" id="FIX_ADMIN_BATCH_PERM_TEMPLATE_NAMESPACE">
		<update tableName="KRIM_PERM_TMPL_T">
			<column name="NMSPC_CD" value="KFS-SYS" />
			<column name="KIM_TYP_ID" value="KFSCNTRB199-TYP1" />
			<where>nmspc_cd = 'KR-NS' AND nm = 'Administer Batch File'</where>
		</update>
	</changeSet>
	
	<changeSet author="KFS50" id="KFSMI6732_PREROUTE_EDIT_DOC_PERM_FOR_PAYMENT_APPLICATION">
		<comment>Creates a permission to allow KR-WKFLW Initiator and KFS-SYS Accounts Receivable Lockbox Manager to edit a Payment Application document pre-route.</comment>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSAR6732"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="PERM_TMPL_ID" valueNumeric=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Edit Document') "/>
			<column name="NMSPC_CD" value="KFS-AR"/>
			<column name="NM" value="Edit APP Document-PreRoute"/>
			<column name="DESC_TXT" value="Edit permission for the Payment Application document prior to the document being submitted."/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSAR6732-1"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="PERM_ID" value="KFSAR6732"/>
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Edit Document') "/>
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') "/>
			<column name="ATTR_VAL" value="APP"/>
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSAR6732-2"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="PERM_ID" value="KFSAR6732"/>
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Edit Document') "/>
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'routeNodeName') "/>
			<column name="ATTR_VAL" value="PreRoute"/>
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSAR6732-1"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="ROLE_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KFS-SYS' and role_nm = 'Accounts Receivable Lockbox Manager') "/>
			<column name="PERM_ID" value="KFSAR6732"/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSAR6732-2"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="ROLE_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KR-WKFLW' and role_nm = 'Initiator') "/>
			<column name="PERM_ID" value="KFSAR6732"/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
	    <modifySql dbms="mysql">
	      <replace replace="sys_guid()" with="uuid()" />
	    </modifySql>
	</changeSet>
	
	<changeSet author="KFS50" id="KFSMI5340_ROLE_FOR_INVOICE_PROCESSING_EDITORS">
		<comment>A new role and a permission associated which will allow a select group of users to edit the processing organization fields on a Customer Invoice document.  Based on SQL by Kalani Ekanayake.</comment>
		<insert tableName="KRIM_ROLE_T">
			<column name="ROLE_ID" value="KFSAR5340R"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="NMSPC_CD" value="KFS-AR"/>
			<column name="ROLE_NM" value="Multi Organization Invoicer"/>
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_TYP_T where nm = 'Default' and nmspc_cd = 'KUALI' and actv_ind = 'Y') "/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSAR5340P"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="PERM_TMPL_ID" valueNumeric=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Use Transactional Document') "/>
			<column name="NMSPC_CD" value="KFS-AR"/>
			<column name="NM" value="Edit Invoice Processing Organization"/>
			<column name="DESC_TXT" value="Users who can edit the Processing Chart Code and the processing organization fields on the Customer Invoice Document."/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSAR5340P-1"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="PERM_ID" value="KFSAR5340P"/>
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Use Transactional Document') "/>
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') "/>
			<column name="ATTR_VAL" value="INV"/>
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSAR5340P-2"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="PERM_ID" value="KFSAR5340P"/>
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Use Transactional Document') "/>
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-NS' and nm = 'editMode') "/>
			<column name="ATTR_VAL" value="processingOrganizationMode"/>
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSAR5340RP"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1"/>
			<column name="ROLE_ID" value="KFSAR5340R"/>
			<column name="PERM_ID" value="KFSAR5340P"/>
			<column name="ACTV_IND" value="Y"/>
		</insert>
	    <modifySql dbms="mysql">
	      <replace replace="sys_guid()" with="uuid()" />
	    </modifySql>
	</changeSet>
	
	<changeSet author="KFS50" id="KFSMI6886_PAYEE_ACH_ADMIN_ROLE">
		<comment>New role for administration of Payee ACH Accounts, with attendant new KIM role type and permissions.  SQL contributed by Ying.</comment>
		<insert tableName="KRIM_TYP_T">
			<column name="KIM_TYP_ID" value="KFSMI6886-TYP"/>
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="NMSPC_CD" value="KFS-PDP" />
			<column name="NM" value="Payee ACH Account" />
			<column name="SRVC_NM" value="{KFS}payeeACHAccountRoleTypeService" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_ATTR_DEFN_T">
			<column name="KIM_ATTR_DEFN_ID" value="KFSMI6886-ATTRDEF" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="NMSPC_CD" value="KFS-PDP" />
			<column name="NM" value="achTransactionTypeCode" />
			<column name="CMPNT_NM" value="org.kuali.kfs.sys.identity.KfsKimAttributes" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_TYP_ATTR_T">
			<column name="KIM_TYP_ATTR_ID" value="KFSMI6886-TYPEATTR" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="SORT_CD" value="a" />
			<column name="KIM_TYP_ID" value="KFSMI6886-TYP" />
			<column name="KIM_ATTR_DEFN_ID" value="KFSMI6886-ATTRDEF" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_ROLE_T">
			<column name="ROLE_ID" value="KFSMI6886-ROLE" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="NMSPC_CD" value="KFS-PDP" />
			<column name="ROLE_NM" value="Payee ACH Accounts Administrator" />
			<column name="DESC_TXT" value="Administration staff who can view and update Payee ACH Account records and the legacy history of a certain ACH Transaction Type." />
			<column name="KIM_TYP_ID" value="KFSMI6886-TYP" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSMI6886-PRM1" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" valueNumeric=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nm = 'Create / Maintain Record(s)' and nmspc_cd = 'KR-NS') " />
			<column name="NMSPC_CD" value="KFS-PDP" />
			<column name="NM" value="Maintain ACH Accounts" />
			<column name="DESC_TXT" value="Allows to view and update Payee ACH Accounts of a certain transaction type." />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI6886-AT1" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI6886-PRM1" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nm = 'Create / Maintain Record(s)' and nmspc_cd = 'KR-NS') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') " />
			<column name="ATTR_VAL" value="PAAT" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI6886-AT2" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI6886-PRM1" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nm = 'Create / Maintain Record(s)' and nmspc_cd = 'KR-NS') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-NS' and nm = 'existingRecordsOnly') " />
			<column name="ATTR_VAL" value="false" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSMI6886-RLPRM1" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="ROLE_ID" value="KFSMI6886-ROLE" />
			<column name="PERM_ID" value="KFSMI6886-PRM1" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSMI6886-PRM2" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" valueNumeric=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nm = 'Look Up Records' and nmspc_cd = 'KR-NS') " />
			<column name="NMSPC_CD" value="KFS-PDP" />
			<column name="NM" value="Lookup ACH Accounts" />
			<column name="DESC_TXT" value="Allows the lookup of Payee ACH Account records of certain transaction type(s)." />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI6886-AT3" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI6886-PRM2" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nm = 'Look Up Records' and nmspc_cd = 'KR-NS') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-NS' and nm = 'componentName') " />
			<column name="ATTR_VAL" value="PayeeACHAccount" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI6886-AT4" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI6886-PRM2" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nm = 'Look Up Records' and nmspc_cd = 'KR-NS') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-NS' and nm = 'namespaceCode') " />
			<column name="ATTR_VAL" value="KFS-PDP" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSMI6886-RLPRM2" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="ROLE_ID" value="KFSMI6886-ROLE" />
			<column name="PERM_ID" value="KFSMI6886-PRM2" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSMI6886-PRM3" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" valueNumeric=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nm = 'Initiate Document' and nmspc_cd = 'KR-SYS') " />
			<column name="NMSPC_CD" value="KFS-PDP" />
			<column name="NM" value="Initiate ACH Account Document" />
			<column name="DESC_TXT" value="Allows initiation the PDP Payee ACH Account maintenance document." />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI6886-AT5" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI6886-PRM3" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nm = 'Initiate Document' and nmspc_cd = 'KR-SYS') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') " />
			<column name="ATTR_VAL" value="PAAT" /> <!-- It's PAAT! -->
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSMI6886-RLPRM3" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KFS-PDP' and role_nm = 'Payee ACH Accounts Administrator') " />
			<column name="PERM_ID" value="KFSMI6886-PRM3" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSMI6886-RLPRM4" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KFS-SYS' and role_nm = 'Operations') " />
			<column name="PERM_ID" value="KFSMI6886-PRM3" />
			<column name="ACTV_IND" value="Y" />
		</insert>
	    <modifySql dbms='mysql'>
	      <replace replace="sys_guid()" with="uuid()" />
	    </modifySql>
	</changeSet>
	
	<changeSet author="KFS50" id="KFSMI7041_PERM_TO_USE_FRINGE_BENEFIT_INQUIRY_ACTION">
		<comment>Create a KR-NS Use Screen template permission for the org.kuali.kfs.module.ld.document.web.struts.FringeBenefitInquiryAction.</comment>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSMI7041-PRM" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" valueNumeric=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Use Screen') " />
			<column name="NMSPC_CD" value="KFS-LD" />
			<column name="NM" value="View Fringe Benefit Inquiry" />
			<column name="DESC_TXT" value="Permits access to screens controlled by org.kuali.kfs.module.ld.document.web.struts.FringeBenefitInquiryAction" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI7041-AT1" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI7041-PRM" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Use Screen') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-SYS' and nm = 'actionClass') " />
			<column name="ATTR_VAL" value="org.kuali.kfs.module.ld.document.web.struts.FringeBenefitInquiryAction" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSMI7041-RLPRM1" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KFS-SYS' and role_nm = 'User') " />
			<column name="PERM_ID" value="KFSMI7041-PRM" />
			<column name="ACTV_IND" value="Y" />
		</insert>
	    <modifySql dbms='mysql'>
	      <replace replace="sys_guid()" with="uuid()" />
	    </modifySql>
	</changeSet>
	
	<changeSet author="KFS50" id="KFSCNTRB162_DEBARRED_VENDOR_TRACKING_PERMS">
		<comment>New parameters for debarred vendor tracking process as well as the permission to upload the vendor exclusion file.</comment>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSCNTRB162-PRM" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" valueNumeric=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Upload Batch Input File(s)') " />
			<column name="NMSPC_CD" value="KFS-VND" />
			<column name="NM" value="Use Vendor Exclude File Upload Screen" />
			<column name="DESC_TXT" value="Authorizes users to access the Vendor Exclude File Upload page." />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB162-AT1" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSCNTRB162-PRM" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Upload Batch Input File(s)') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nm = 'beanName') " />
			<column name="ATTR_VAL" value="vendorExcludeInputFileType" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSCNTRB162-RLPRM1" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KFS-VND' and role_nm = 'Reviewer') " />
			<column name="PERM_ID" value="KFSCNTRB162-PRM" />
			<column name="ACTV_IND" value="Y" />
		</insert>
	    <modifySql dbms='mysql'>
	      <replace replace="sys_guid()" with="uuid()" />
	    </modifySql>
	</changeSet>

	<changeSet author="KFS50" id="KFSCNTRB199_PERMS">
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSCNTRB199-P1" />
			<column name="OBJ_ID" value="KFSCNTRB199-P1"/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" value="33" />
			<column name="NMSPC_CD" value="KFS-SYS" />
			<column name="NM" value="Upload semaphoreInputFileTypeError" />
			<column name="DESC_TXT" value="Authorizes users to access the Batch Semaphore File Upload page." />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB199-PATD" />
			<column name="OBJ_ID" value="KFSCNTRB199-PATD" />
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSCNTRB199-P1" />
			<column name="KIM_TYP_ID" value="15" />
			<column name="KIM_ATTR_DEFN_ID" value="1" />
			<column name="ATTR_VAL" value="semaphoreInputFileTypeError" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSCNTRB199-RP1" />
			<column name="OBJ_ID" value="KFSCNTRB199-RP1"/>
			<column name="VER_NBR" value="1" />
			<column name="ROLE_ID" value="51" />
			<column name="PERM_ID" value="KFSCNTRB199-P1" />
			<column name="ACTV_IND" value="Y" />
		</insert>

		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSCNTRB199-P2" />
			<column name="OBJ_ID" value="KFSCNTRB199-P2"/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" value="50" />
			<column name="NMSPC_CD" value="KFS-SYS" />
			<column name="NM" value="Administer Batch File KFS-SYS batchContainer" />
			<column name="DESC_TXT" value="Authorizes users to view the batch files using the Batch File lookup screen" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB199-PAD2" />
			<column name="OBJ_ID" value="KFSCNTRB199-PAD2" />
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSCNTRB199-P2" />
			<column name="KIM_TYP_ID" value="KFSCNTRB199-TYP1" />
			<column name="KIM_ATTR_DEFN_ID" value="4" />
			<column name="ATTR_VAL" value="KFS-SYS" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB199-PAD3" />
			<column name="OBJ_ID" value="KFSCNTRB199-PAD3" />
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSCNTRB199-P2" />
			<column name="KIM_TYP_ID" value="KFSCNTRB199-TYP1" />
			<column name="KIM_ATTR_DEFN_ID" value="KFSCNTRB199-ATTRDEF1" />
			<column name="ATTR_VAL" value="staging/sys/batchContainer/*" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSCNTRB199-RP2" />
			<column name="OBJ_ID" value="KFSCNTRB199-RP2"/>
			<column name="VER_NBR" value="1" />
			<column name="ROLE_ID" value="51" />
			<column name="PERM_ID" value="KFSCNTRB199-P2" />
			<column name="ACTV_IND" value="Y" />
		</insert>
	</changeSet>
	
	<changeSet author="KFS50" id="WORKSTUDY_WORKFLOW_UPDATES">
		<comment>Responsibilities and Role for Workstudy routing within labor module.</comment>
		<insert tableName="KRIM_RSP_T">
			<column name="RSP_ID" value="KFSCNTRB789-RSP1" />
			<column name="OBJ_ID" value="KFSCNTRB789-RSP1" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="RSP_TMPL_ID" value="1" />
			<column name="NMSPC_CD" value="KFS-LD" />
			<column name="NM" value="Review ST Workstudy" />
			<column name="DESC_TXT" value="" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_RSP_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB789-RAD1" />
			<column name="OBJ_ID" value="KFSCNTRB789-RAD1" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="RSP_ID" value="KFSCNTRB789-RSP1" />
			<column name="KIM_TYP_ID" value="7" />
			<column name="KIM_ATTR_DEFN_ID" value="13" />
			<column name="ATTR_VAL" value="ST" />
		</insert>
		<insert tableName="KRIM_RSP_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB789-RAD2" />
			<column name="OBJ_ID" value="KFSCNTRB789-RAD2" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="RSP_ID" value="KFSCNTRB789-RSP1" />
			<column name="KIM_TYP_ID" value="7" />
			<column name="KIM_ATTR_DEFN_ID" value="16" />
			<column name="ATTR_VAL" value="Workstudy" />
		</insert>
		<insert tableName="KRIM_RSP_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB789-RAD3" />
			<column name="OBJ_ID" value="KFSCNTRB789-RAD3" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="RSP_ID" value="KFSCNTRB789-RSP1" />
			<column name="KIM_TYP_ID" value="7" />
			<column name="KIM_ATTR_DEFN_ID" value="40" />
			<column name="ATTR_VAL" value="false" />
		</insert>
		<insert tableName="KRIM_RSP_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB789-RAD4" />
			<column name="OBJ_ID" value="KFSCNTRB789-RAD4" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="RSP_ID" value="KFSCNTRB789-RSP1" />
			<column name="KIM_TYP_ID" value="7" />
			<column name="KIM_ATTR_DEFN_ID" value="41" />
			<column name="ATTR_VAL" value="false" />
		</insert>

		<insert tableName="KRIM_RSP_T">
			<column name="RSP_ID" value="KFSCNTRB789-RSP2" />
			<column name="OBJ_ID" value="KFSCNTRB789-RSP2" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="RSP_TMPL_ID" value="1" />
			<column name="NMSPC_CD" value="KFS-EC" />
			<column name="NM" value="Review ECD Workstudy" />
			<column name="DESC_TXT" value="" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_RSP_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB789-RAD5" />
			<column name="OBJ_ID" value="KFSCNTRB789-RAD5" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="RSP_ID" value="KFSCNTRB789-RSP2" />
			<column name="KIM_TYP_ID" value="7" />
			<column name="KIM_ATTR_DEFN_ID" value="13" />
			<column name="ATTR_VAL" value="ECD" />
		</insert>
		<insert tableName="KRIM_RSP_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB789-RAD6" />
			<column name="OBJ_ID" value="KFSCNTRB789-RAD6" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="RSP_ID" value="KFSCNTRB789-RSP2" />
			<column name="KIM_TYP_ID" value="7" />
			<column name="KIM_ATTR_DEFN_ID" value="16" />
			<column name="ATTR_VAL" value="Workstudy" />
		</insert>
		<insert tableName="KRIM_RSP_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB789-RAD7" />
			<column name="OBJ_ID" value="KFSCNTRB789-RAD7" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="RSP_ID" value="KFSCNTRB789-RSP2" />
			<column name="KIM_TYP_ID" value="7" />
			<column name="KIM_ATTR_DEFN_ID" value="40" />
			<column name="ATTR_VAL" value="false" />
		</insert>
		<insert tableName="KRIM_RSP_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSCNTRB789-RAD8" />
			<column name="OBJ_ID" value="KFSCNTRB789-RAD8" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="RSP_ID" value="KFSCNTRB789-RSP2" />
			<column name="KIM_TYP_ID" value="7" />
			<column name="KIM_ATTR_DEFN_ID" value="41" />
			<column name="ATTR_VAL" value="false" />
		</insert>
	
	
		<insert tableName="KRIM_ROLE_T">
			<column name="ROLE_ID" value="KFSCNTRB789-ROLE1" />
			<column name="OBJ_ID" value="KFSCNTRB789-ROLE1" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_NM" value="Workstudy Reviewer" />
			<column name="NMSPC_CD" value="KFS-SYS" />
			<column name="DESC_TXT" value="Workstudy Reviewer Role" />
			<column name="KIM_TYP_ID" value="1" />
			<column name="ACTV_IND" value="Y" />
		</insert>

		<insert tableName="KRIM_ROLE_RSP_T">
			<column name="ROLE_RSP_ID" value="KFSCNTRB789-RR1" />
			<column name="OBJ_ID" value="KFSCNTRB789-RR1" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" value="KFSCNTRB789-ROLE1" />
			<column name="RSP_ID" value="KFSCNTRB789-RSP1" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_ROLE_RSP_T">
			<column name="ROLE_RSP_ID" value="KFSCNTRB789-RR2" />
			<column name="OBJ_ID" value="KFSCNTRB789-RR2" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" value="KFSCNTRB789-ROLE1" />
			<column name="RSP_ID" value="KFSCNTRB789-RSP2" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_ROLE_RSP_ACTN_T">
			<column name="ROLE_RSP_ACTN_ID" value="KFSCNTRB789-RRA1" />
			<column name="OBJ_ID" value="KFSCNTRB789-RRA1" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ACTN_TYP_CD" value="A" />
			<column name="PRIORITY_NBR" valueNumeric="1" />
			<column name="ACTN_PLCY_CD" value="F" />
			<column name="ROLE_MBR_ID" value="*" />
			<column name="ROLE_RSP_ID" value="KFSCNTRB789-RR1" />
			<column name="FRC_ACTN" value="N" />
		</insert>
		<insert tableName="KRIM_ROLE_RSP_ACTN_T">
			<column name="ROLE_RSP_ACTN_ID" value="KFSCNTRB789-RRA2" />
			<column name="OBJ_ID" value="KFSCNTRB789-RRA2" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ACTN_TYP_CD" value="A" />
			<column name="PRIORITY_NBR" valueNumeric="1" />
			<column name="ACTN_PLCY_CD" value="F" />
			<column name="ROLE_MBR_ID" value="*" />
			<column name="ROLE_RSP_ID" value="KFSCNTRB789-RR2" />
			<column name="FRC_ACTN" value="N" />
		</insert>
	
	</changeSet>
	
	<changeSet author="KFS50" id="GRANT_LOOKUP_TO_PAYEE_ACH_ACCTS_ADMIN">
		<comment>Payee ACH Account document require permission to Lookup on the Payee Number field</comment>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSPDP8271-01" />
			<column name="OBJ_ID" value="KFSPDP8271-01" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" value="KFSMI6886-ROLE" />
			<column name="PERM_ID" value="89" />
			<column name="ACTV_IND" value="Y" />
		</insert>
	</changeSet>
		
	<changeSet author="KFS50" id="RESTORE_INQUIRY_ON_RICE_OBJECTS">
		<comment>Restore a few permissions which were lost from Rice objects between KFS versions.</comment>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFS50-2" />
			<column name="OBJ_ID" value="KFS50-2" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from krim_role_t WHERE NMSPC_CD = 'KFS-SYS' AND ROLE_NM = 'User') " />
			<column name="PERM_ID" valueNumeric=" (select perm_id from krim_perm_t WHERE nmspc_cd = 'KR-NS' AND NM = 'Inquire Into Namespace') " />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFS50-3" />
			<column name="OBJ_ID" value="KFS50-3" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from krim_role_t WHERE NMSPC_CD = 'KFS-SYS' AND ROLE_NM = 'Active Faculty or Staff') " />
			<column name="PERM_ID" valueNumeric=" (select perm_id from krim_perm_t WHERE nmspc_cd = 'KR-NS' AND NM = 'Inquire Into Namespace') " />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFS50-4" />
			<column name="OBJ_ID" value="KFS50-4" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from krim_role_t WHERE NMSPC_CD = 'KFS-SYS' AND ROLE_NM = 'User') " />
			<column name="PERM_ID" valueNumeric=" (select perm_id from krim_perm_t WHERE nmspc_cd = 'KR-NS' AND NM = 'Inquire Into Parameter Component') " />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFS50-5" />
			<column name="OBJ_ID" value="KFS50-5" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from krim_role_t WHERE NMSPC_CD = 'KFS-SYS' AND ROLE_NM = 'Active Faculty or Staff') " />
			<column name="PERM_ID" valueNumeric=" (select perm_id from krim_perm_t WHERE nmspc_cd = 'KR-NS' AND NM = 'Inquire Into Parameter Component') " />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFS50-6" />
			<column name="OBJ_ID" value="KFS50-6" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from krim_role_t WHERE NMSPC_CD = 'KFS-SYS' AND ROLE_NM = 'User') " />
			<column name="PERM_ID" valueNumeric=" (select perm_id from krim_perm_t WHERE nmspc_cd = 'KR-NS' AND NM = 'Inquire Into Parameter Type') " />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFS50-7" />
			<column name="OBJ_ID" value="KFS50-7" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from krim_role_t WHERE NMSPC_CD = 'KFS-SYS' AND ROLE_NM = 'Active Faculty or Staff') " />
			<column name="PERM_ID" valueNumeric=" (select perm_id from krim_perm_t WHERE nmspc_cd = 'KR-NS' AND NM = 'Inquire Into Parameter Type') " />
			<column name="ACTV_IND" value="Y" />
		</insert>
	</changeSet>
	<changeSet author="KFS50" id="AUTHORIZE_ICR_USERS_TO_EDIT">
		<comment>Authorizes Contracts and Grants Processors to edit the IndirectCostRecoveryAccounts section on the Sub-Account document</comment>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSMI8342-PRM" />
			<column name="OBJ_ID" value="KFSMI8342-PRM"/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" value="44" />
			<column name="NMSPC_CD" value="KFS-COA" />
			<column name="NM" value="Modify Maintenance Document Section SubAccount indirectCostRecoveryAccounts" />
			<column name="DESC_TXT" value="Authorizes users to edit the IndirectCostRecoveryAccounts section on the Sub-Account document." />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI8342-PRMATT1" />
			<column name="OBJ_ID" value="KFSMI8342-PRMATT1" />
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI8342-PRM" />
			<column name="KIM_TYP_ID" value="57" />
			<column name="KIM_ATTR_DEFN_ID" value="44" />
			<column name="ATTR_VAL" value="indirectCostRecoveryAccounts" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI8342-PRMATT2" />
			<column name="OBJ_ID" value="KFSMI8342-PRMATT2" />
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI8342-PRM" />
			<column name="KIM_TYP_ID" value="57" />
			<column name="KIM_ATTR_DEFN_ID" value="5" />
			<column name="ATTR_VAL" value="SubAccount" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSMI8342-RLPRM" />
			<column name="OBJ_ID" value="KFSMI8342-RLPRM" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" value="39" />
			<column name="PERM_ID" value="KFSMI8342-PRM" />
			<column name="ACTV_IND" value="Y" />
		</insert>
	</changeSet>	
	<changeSet author="KFS50" id="KFSMI-8182_Attachment_Document_Opener_role">	
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSMI8146" />
			<column name="OBJ_ID" value="KFSMI8146" />
			<column name="VER_NBR" valueNumeric="1" />
			<column name="ROLE_ID" value="83" />
			<column name="PERM_ID" value="259" />
			<column name="ACTV_IND" value="Y" />
		</insert>
	</changeSet>	
	<changeSet author="KFS50" id="KFSMI8906_KFSMI8497_PERM_CONTRACT_MANAGER_EDIT_PO_ACCT_LINES">
		<comment>Create a new permission to allow Contract Managers to edit Accounting Lines when a PO is at the Awaiting Purchasing Approval route node.</comment>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSMI8906-PRM" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" valueNumeric=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KFS-SYS' and nm = 'Modify Accounting Lines') " />
			<column name="NMSPC_CD" value="KFS-PURAP" />
			<column name="NM" value="Modify Acct Lines PO Pur Process itemssourceAccountingLines" />
			<column name="DESC_TXT" value="Allows users to modify the accounting lines on a PO Document that is at Awaiting Purchasing Approval status" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI8906-PRMATT1" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI8906-PRM" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KFS-SYS' and nm = 'Modify Accounting Lines') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-NS' and nm = 'propertyName') " />
			<column name="ATTR_VAL" value="items.sourceAccountingLines" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI8906-PRMATT2" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI8906-PRM" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KFS-SYS' and nm = 'Modify Accounting Lines') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'routeNodeName') " />
			<column name="ATTR_VAL" value="ContractManagement" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI8906-PRMATT3" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI8906-PRM" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KFS-SYS' and nm = 'Modify Accounting Lines') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') " />
			<column name="ATTR_VAL" value="PO" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSMI8906-RLPRM" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KFS-PURAP' and role_nm = 'Purchasing Processor') " />
			<column name="PERM_ID" value="KFSMI8906-PRM" />
			<column name="ACTV_IND" value="Y" />
		</insert>
	    <modifySql dbms='mysql'>
	      <replace replace="sys_guid()" with="uuid()" />
	    </modifySql>
	</changeSet>
	
	<changeSet id="REMOVE_EXTRA_ROUTE_LOG_MESSAGE_PERM" author="KFS50">
		<comment>Remove a permission which should not have been present in the prior KFS dataset.</comment>
		<delete tableName="KRIM_ROLE_PERM_T">
			<where> role_id = (select role_id from KRIM_ROLE_T where nmspc_cd = 'KR-SYS' and role_nm = 'Technical Administrator') 
				AND perm_id = (select perm_id from KRIM_PERM_T WHERE nmspc_cd = 'KUALI' AND nm = 'Add Message to Route Log')
			</where>
		</delete>		
	</changeSet>
	
	<changeSet author="KFS50" id="KFSMI8944_PERM_FOR_KFSMI8882_ALLOW_TAX_MANAGERS_TO_APPROVE_PO">
		<comment>Create a new permission to allow Tax Managers to approve a PO (currently getting error message that Accounting Lines may not be updated.</comment>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSMI8944-PRM" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" valueNumeric=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KFS-SYS' and nm = 'Modify Accounting Lines') " />
			<column name="NMSPC_CD" value="KFS-PURAP" />
			<column name="NM" value="Modify Accounting Lines PUR Tax itemsourceAccountingLines" />
			<column name="DESC_TXT" value="Allows users to modify the Source accounting lines on documents answering to the parent document Purchasing Transactional Document when a document is at the Tax Node of routing." />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI8944-PRMATT1" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI8944-PRM" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KFS-SYS' and nm = 'Modify Accounting Lines') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-NS' and nm = 'propertyName') " />
			<column name="ATTR_VAL" value="items.sourceAccountingLines" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI8944-PRMATT2" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI8944-PRM" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KFS-SYS' and nm = 'Modify Accounting Lines') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'routeNodeName') " />
			<column name="ATTR_VAL" value="Tax" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI8944-PRMATT3" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI8944-PRM" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KFS-SYS' and nm = 'Modify Accounting Lines') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') " />
			<column name="ATTR_VAL" value="PUR" />
		</insert>
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSMI8944-RLPRM" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KR-NS' and role_nm = 'Document Editor') " />
			<column name="PERM_ID" value="KFSMI8944-PRM" />
			<column name="ACTV_IND" value="Y" />
		</insert>
	    <modifySql dbms='mysql'>
	      <replace replace="sys_guid()" with="uuid()" />
	    </modifySql>
	</changeSet>
	
	<changeSet author="KFS50" id="KFSMI8893_PERMS_RESTRICT_RECALL_TO_FP_DOCS">
		<comment>Create two new permissions to restrict Recall Document functionality in KFS to FP documents.</comment>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSMI8893-PRM1" />
			<column name="OBJ_ID" valueComputed="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" valueComputed=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-WKFLW' and nm = 'Recall Document') " />
			<column name="NMSPC_CD" value="KFS-FP" />
			<column name="NM" value="Recall Document FP" />
			<column name="DESC_TXT" value="Enable Recall Document functionality for KFS FP documents." />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI8893-PRM1ATT1" />
			<column name="OBJ_ID" valueComputed="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI8893-PRM1" />
			<column name="KIM_TYP_ID" valueComputed=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-WKFLW' and nm = 'Recall Document') " />
			<column name="KIM_ATTR_DEFN_ID" valueComputed=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') " />
			<column name="ATTR_VAL" value="FP" />
		</insert>
		<!-- 
		<insert tableName="KRIM_ROLE_PERM_T">
			<column name="ROLE_PERM_ID" value="KFSMI8893-RLPRM1" />
			<column name="OBJ_ID" valueNumeric="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="ROLE_ID" valueNumeric=" (select role_id from KRIM_ROLE_T where nmspc_cd = 'KR-WKFLW' and role_nm = 'Initiator') " />
			<column name="PERM_ID" value="KFSMI8893-PRM1" />
			<column name="ACTV_IND" value="Y" />
		</insert>
		 -->
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSMI8893-PRM2" />
			<column name="OBJ_ID" valueComputed="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" valueComputed=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-WKFLW' and nm = 'Recall Document') " />
			<column name="NMSPC_CD" value="KFS-SYS" />
			<column name="NM" value="Recall Document KFS" />
			<column name="DESC_TXT" value="Recall Document functionality for KFS documents." />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI8893-PRM2ATT1" />
			<column name="OBJ_ID" valueComputed="sys_guid() "/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI8893-PRM2" />
			<column name="KIM_TYP_ID" valueComputed=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-WKFLW' and nm = 'Recall Document') " />
			<column name="KIM_ATTR_DEFN_ID" valueComputed=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') " />
			<column name="ATTR_VAL" value="KFS" />
		</insert>
	    <modifySql dbms="mysql">
	      <replace replace="sys_guid()" with="uuid()" />
	    </modifySql>
	</changeSet>
	
	<changeSet id="REMOVE_RA_DOC_RESP" author="KFS50">
		<comment>Remove responsbility for document not present in KFS since version 2.0.</comment>
		<delete tableName="KRIM_ROLE_RSP_ACTN_T">
			<where>role_rsp_id IN (
				SELECT role_rsp_id FROM KRIM_ROLE_RSP_T
					WHERE rsp_id = (select rsp_id from KRIM_RSP_T where nmspc_cd = 'KFS-CG' AND nm = 'Review RA ProjectManagement')
				)
			</where>
		</delete>
		<delete tableName="KRIM_ROLE_RSP_T">
			<where>rsp_id = (select rsp_id from KRIM_RSP_T where nmspc_cd = 'KFS-CG' AND nm = 'Review RA ProjectManagement')</where>
		</delete>
		<delete tableName="KRIM_RSP_ATTR_DATA_T">
			<where>rsp_id = (select rsp_id from KRIM_RSP_T where nmspc_cd = 'KFS-CG' AND nm = 'Review RA ProjectManagement')</where>
		</delete>
		<delete tableName="KRIM_RSP_T">
			<where>nmspc_cd = 'KFS-CG' AND nm = 'Review RA ProjectManagement'</where>
		</delete>
	</changeSet>

	<changeSet author="KFS50" id="KFSMI9071_DISABLE_ADHOC_ROUTE_FOR_COMPLETION_IN_KFS">
		<comment>Create a new permission without assigning to a role to disble Adhoc route for completion in KFS.</comment>
		<insert tableName="KRIM_PERM_T">
			<column name="PERM_ID" value="KFSMI9071-PRM1" />
			<column name="OBJ_ID" value="KFSMI9071-PRM1"/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_TMPL_ID" valueNumeric=" (select perm_tmpl_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Send Ad Hoc Request') " />
			<column name="NMSPC_CD" value="KFS-SYS" />
			<column name="NM" value="Send Complete Request KFS" />
			<column name="DESC_TXT" value="Authorizes users to send Complete ad hoc requests for KFS Documents." />
			<column name="ACTV_IND" value="Y" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI9071-PRM1ATT1" />
			<column name="OBJ_ID" value="KFSMI9071-PRM1ATT1"/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI9071-PRM1" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Send Ad Hoc Request') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'documentTypeName') " />
			<column name="ATTR_VAL" value="KFS" />
		</insert>
		<insert tableName="KRIM_PERM_ATTR_DATA_T">
			<column name="ATTR_DATA_ID" value="KFSMI9071-PRM1ATT2" />
			<column name="OBJ_ID" value="KFSMI9071-PRM1ATT2"/>
			<column name="VER_NBR" value="1" />
			<column name="PERM_ID" value="KFSMI9071-PRM1" />
			<column name="KIM_TYP_ID" valueNumeric=" (select kim_typ_id from KRIM_PERM_TMPL_T where nmspc_cd = 'KR-NS' and nm = 'Send Ad Hoc Request') " />
			<column name="KIM_ATTR_DEFN_ID" valueNumeric=" (select kim_attr_defn_id from KRIM_ATTR_DEFN_T where nmspc_cd = 'KR-WKFLW' and nm = 'actionRequestCd') " />
			<column name="ATTR_VAL" value="C" />
		</insert>
	</changeSet>
		
</databaseChangeLog>