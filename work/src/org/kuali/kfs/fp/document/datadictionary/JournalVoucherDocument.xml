<beans xmlns="http://www.springframework.org/schema/beans"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xmlns:p="http://www.springframework.org/schema/p"
    xsi:schemaLocation="http://www.springframework.org/schema/beans
        http://www.springframework.org/schema/beans/spring-beans-2.0.xsd">

  <bean id="JournalVoucherDocument" parent="JournalVoucherDocument-parentBean" />

  <bean id="JournalVoucherDocument-parentBean" abstract="true" parent="TransactionalDocumentEntry">
    <property name="allowsErrorCorrection" value="true" />
    <property name="label" value="Journal Voucher" />
    <property name="shortLabel" value="Journal Voucher" />
    <property name="summary" value="&amp;nbsp;" />
    <property name="description" value="The Journal Voucher (JV) document is used to perform accounting tasks that cannot be done by any of the specialized financial documents. The JV document is a very open ended financial transactions document, with few checks of business rules. The main purpose of the Journal Voucher is to record accruals and allocations, and to adjust entries. The JV document can also be used to fix errors that may occur in the system which inadvertently put the General Ledger out of balance." />
    <property name="helpDefinition" >
      <bean parent="HelpDefinition" p:parameterClass="org.kuali.kfs.fp.document.JournalVoucherDocument" p:parameterName="JOURNAL_VOUCHER" />
    </property>
    <property name="documentTypeName" value="JournalVoucherDocument" />
    <property name="documentClass" value="org.kuali.kfs.fp.document.JournalVoucherDocument" />
    <property name="businessRulesClass" value="org.kuali.kfs.sys.document.validation.impl.AccountingRuleEngineRuleBase" />
    <property name="documentAuthorizerClass" value="org.kuali.kfs.fp.document.authorization.JournalVoucherDocumentAuthorizer" />
    <property name="documentTypeCode" value="JV" />
    <property name="sessionDocument" value="true" />
    <property name="allowsCopy" value="true" />
    <property name="workflowProperties" >
      <ref bean="JournalVoucherDocument-workflowProperties" />
    </property>
    <property name="authorizations" >
      <list>
        <bean parent="AuthorizationDefinition">
          <property name="action" value="initiate" />
          <property name="authorizedGroups" >
            <set>
              <value>FP_JOURNAL_VOUCHER_USERS</value>
            </set>
          </property>
        </bean>
      </list>
    </property>
    <property name="attributes" >
      <list>
        <ref bean="JournalVoucherDocument-accountingPeriod" />
        <ref bean="JournalVoucherDocument-reversalDate" />
        <ref bean="JournalVoucherDocument-balanceTypeCode" />
      </list>
    </property>
    <property name="validationMap" ref="JournalVoucherDocument-validations" />
    
    <property name="accountingLineGroups">
    	<map>
    		<entry>
    			<key><value>source</value></key>
	    		<ref bean="JournalVoucherDocument-sourceAccountingLineGroup" parent="AccountingLineGroup" />
	    	</entry>
	    	<entry>
    			<key><value>source-withExtEncumbrance</value></key>
	    		<ref bean="JournalVoucherDocument-sourceAccountingLineGroup-withExtEncumbrance" parent="AccountingLineGroup" />
	    	</entry>
    		<entry>
    			<key><value>source-withDebitCredit</value></key>
	    		<ref bean="JournalVoucherDocument-sourceAccountingLineGroup-withDebitCredit" parent="AccountingLineGroup" />
	    	</entry>
	    	<entry>
    			<key><value>source-withDebitCreditExtEncumbrance</value></key>
	    		<ref bean="JournalVoucherDocument-sourceAccountingLineGroup-withDebitCreditExtEncumbrance" parent="AccountingLineGroup" />
	    	</entry>	    	
    	</map>
    </property>
    <property name="importedLineParserClass" value="org.kuali.kfs.sys.businessobject.AccountingLineParserBase" />     
  </bean>

<!-- Attribute Definitions -->


  <bean id="JournalVoucherDocument-accountingPeriod" parent="JournalVoucherDocument-accountingPeriod-parentBean" />

  <bean id="JournalVoucherDocument-accountingPeriod-parentBean" abstract="true" parent="AttributeDefinition">
    <property name="name" value="accountingPeriod" />
    <property name="forceUppercase" value="false" />
    <property name="label" value="Accounting Period" />
    <property name="shortLabel" value="Acct. Prd." />
    <property name="maxLength" value="50" />
    <property name="validationPattern" >
      <bean parent="AnyCharacterValidationPattern" />
    </property>
    <property name="required" value="true" />
    <property name="control" >
      <bean parent="TextControlDefinition"
            p:size="50" />
    </property>
    <property name="summary" value="&amp;nbsp;" />
    <property name="description" value="The calendar accounting periods during which the Journal Voucher applies. Select one from the pulldown list." />
  </bean>
  <bean id="JournalVoucherDocument-reversalDate" parent="JournalVoucherDocument-reversalDate-parentBean" />

  <bean id="JournalVoucherDocument-reversalDate-parentBean" abstract="true" parent="GenericAttributes-genericDate">
    <property name="name" value="reversalDate" />
    <property name="label" value="Reversal Date" />
    <property name="shortLabel" value="Reversal Date" />
    <property name="required" value="false" />
    <property name="description" value="The date when the Kuali Financial System (KFS) will automatically reverse the General Ledger entries entered on the document's date. Use the calendar icon to select and format the Reversal Date." />
  </bean>
  <bean id="JournalVoucherDocument-balanceTypeCode" parent="JournalVoucherDocument-balanceTypeCode-parentBean" />

  <bean id="JournalVoucherDocument-balanceTypeCode-parentBean" abstract="true" parent="BalanceTyp-code">
    <property name="name" value="balanceTypeCode" />
    <property name="summary" value="&amp;nbsp;" />
    <property name="description" value="The 2-character code and text describing the type of balance involved in the Journal Voucher. Select one from the pulldown list." />
  </bean>

<!-- Exported Workflow Properties -->

  <bean id="JournalVoucherDocument-workflowProperties" parent="JournalVoucherDocument-workflowProperties-parentBean" />

  <bean id="JournalVoucherDocument-workflowProperties-parentBean" abstract="true" parent="WorkflowProperties">
    <property name="workflowPropertyGroups" >
      <list>
        <bean parent="WorkflowPropertyGroup">
          <property name="workflowProperties" >
            <list>
              <bean parent="WorkflowProperty"
                    p:path="documentHeader" />
              <bean parent="WorkflowProperty"
                    p:path="sourceAccountingLines" />
            </list>
          </property>
        </bean>
      </list>
    </property>
  </bean>
  
  <!-- validations -->
  
  <bean id="JournalVoucherDocument-validations" parent="JournalVoucherDocument-validations-parentBean" />
  
  <bean id="JournalVoucherDocument-validations-parentBean" class="org.springframework.beans.factory.config.MapFactoryBean">
  	<property name="sourceMap">
		<map>
			<entry>
				<key><value>org.kuali.kfs.sys.document.validation.event.AttributedRouteDocumentEvent</value></key>
				<value>JournalVoucher-routeDocumentValidation</value>
			</entry>
			<entry>
				<key><value>org.kuali.kfs.sys.document.validation.event.AttributedSaveDocumentEvent</value></key>
				<value>JournalVoucher-saveDocumentValidation</value>
			</entry>
			<entry>
				<key><value>org.kuali.kfs.sys.document.validation.event.AttributedApproveDocumentEvent</value></key>
				<value>JournalVoucher-approveDocumentValidation</value>
			</entry>
			<entry>
				<key><value>org.kuali.kfs.sys.document.validation.event.AttributedBlanketApproveDocumentEvent</value></key>
				<value>JournalVoucher-blanketApproveDocumentValidation</value>
			</entry>
			<entry>
				<key><value>org.kuali.kfs.sys.document.validation.event.AttributedAddAccountingLineEvent</value></key>
				<value>JournalVoucher-addAccountingLineValidation</value>
			</entry>
			<entry>
				<key><value>org.kuali.kfs.sys.document.validation.event.AttributedDeleteAccountingLineEvent</value></key>
				<value>JournalVoucher-deleteAccountingLineValidation</value>
			</entry>
			<entry>
				<key><value>org.kuali.kfs.sys.document.validation.event.AttributedUpdateAccountingLineEvent</value></key>
				<value>JournalVoucher-updateAccountingLineValidation</value>
			</entry>
			<entry>
				<key><value>org.kuali.kfs.sys.document.validation.event.AttributedReviewAccountingLineEvent</value></key>
				<value>JournalVoucher-reviewAccountingLineValidation</value>
			</entry>
    	</map>
    </property>
  </bean>

  <!-- accounting line groups -->
  <bean id="JournalVoucherDocument-sourceAccountingLineGroup" parent="JournalVoucherDocument-sourceAccountingLineGroup-parentBean" />  
  <bean id="JournalVoucherDocument-sourceAccountingLineGroup-parentBean" parent="AccountingLineGroup" abstract="true">
	  <property name="accountingLineView" ref="Voucher-accountingLineView" />
	  <property name="accountingLineClass" value="org.kuali.kfs.sys.businessobject.SourceAccountingLine" />
	  <property name="groupLabel" value="Source" />
	  <property name="accountingLineAuthorizerClass" value="org.kuali.kfs.fp.document.authorization.FinancialProcessingAccountingLineAuthorizer" />
	  <property name="importedLinePropertyPrefix" value="source" />
	  <property name="totals" ref="AccountingDocument-sourceGroupTotals" />
	  <property name="errorKey" value="document.sourceAccounting*,sourceAccountingLines,newSourceLine*,voucherLineHelpers*" /> 
  </bean>  
  
  <bean id="JournalVoucherDocument-sourceAccountingLineGroup-withExtEncumbrance" parent="JournalVoucherDocument-sourceAccountingLineGroup-withExtEncumbrance-parentBean" />  
  <bean id="JournalVoucherDocument-sourceAccountingLineGroup-withExtEncumbrance-parentBean" parent="AccountingLineGroup" abstract="true">
	  <property name="accountingLineView" ref="Voucher-accountingLineView-withExtEncumbrance" />
	  <property name="accountingLineClass" value="org.kuali.kfs.sys.businessobject.SourceAccountingLine" />
	  <property name="groupLabel" value="Source" />
	  <property name="accountingLineAuthorizerClass" value="org.kuali.kfs.fp.document.authorization.FinancialProcessingAccountingLineAuthorizer" />
	  <property name="importedLinePropertyPrefix" value="source" />
	  <property name="totals" ref="AccountingDocument-sourceGroupTotals" />
	  <property name="errorKey" value="document.sourceAccounting*,sourceAccountingLines,newSourceLine*,voucherLineHelpers*" /> 
  </bean> 
  
  <bean id="JournalVoucherDocument-sourceAccountingLineGroup-withDebitCredit" parent="JournalVoucherDocument-sourceAccountingLineGroup-withDebitCredit-parentBean" />  
  <bean id="JournalVoucherDocument-sourceAccountingLineGroup-withDebitCredit-parentBean" parent="AccountingLineGroup" abstract="true">
	  <property name="accountingLineView" ref="Voucher-accountingLineView-withDebitCredit" />
	  <property name="accountingLineClass" value="org.kuali.kfs.sys.businessobject.SourceAccountingLine" />
	  <property name="groupLabel" value="Source" />
	  <property name="accountingLineAuthorizerClass" value="org.kuali.kfs.fp.document.authorization.FinancialProcessingAccountingLineAuthorizer" />
	  <property name="importedLinePropertyPrefix" value="source" />
	  <property name="totals" ref="AccountingDocument-sourceDebitCerditTotals" />
	  <property name="errorKey" value="document.sourceAccounting*,sourceAccountingLines,newSourceLine*,voucherLineHelpers*" /> 
  </bean>  
  
  <bean id="JournalVoucherDocument-sourceAccountingLineGroup-withDebitCreditExtEncumbrance" parent="JournalVoucherDocument-sourceAccountingLineGroup-withDebitCreditExtEncumbrance-parentBean" />  
  <bean id="JournalVoucherDocument-sourceAccountingLineGroup-withDebitCreditExtEncumbrance-parentBean" parent="AccountingLineGroup" abstract="true">
	  <property name="accountingLineView" ref="Voucher-accountingLineView-withDebitCreditExtEncumbrance" />
	  <property name="accountingLineClass" value="org.kuali.kfs.sys.businessobject.SourceAccountingLine" />
	  <property name="groupLabel" value="Source" />
	  <property name="accountingLineAuthorizerClass" value="org.kuali.kfs.fp.document.authorization.FinancialProcessingAccountingLineAuthorizer" />
	  <property name="importedLinePropertyPrefix" value="source" />
	  <property name="totals" ref="AccountingDocument-sourceDebitCerditTotals" />
	  <property name="errorKey" value="document.sourceAccounting*,sourceAccountingLines,newSourceLine*,voucherLineHelpers*" /> 
  </bean>  
</beans>
